var K_ENV="prod",K_ENV_DEV="dev",K_ENV_TEST="test",K_ENV_PROD="prod";import{A as addListener,a as append,b as assign,c as assignTrue,d as createElement,f as createText,v as destroyEach,g as detachNode,h as flush,i as init,j as insert,l as proto,B as removeListener,Y as selectOption,Z as selectValue,w as setData,u as createComment,O as reinsertChildren,m as removeFromStore,z as Loader,_ as createHOC}from"./chunk-4772d5c0.js";import{a as Router}from"./chunk-5811b7a5.js";import{a as GridView,b as TileView,c as DataSearch,d as Pagination}from"./chunk-ec71f95d.js";function data(){return{options:[],sort:"",value:""}}function onstate({changed:e,current:t}){e.sort&&this.set({value:t.sort.replace("%20"," ")})}function get_each_context(e,t,a){const r=Object.create(e);return r.opt=t[a],r}function create_main_fragment(e,t){for(var a,r,s,i,n,o,l,_,c=!1,m=t.options,h=[],p=0;p<m.length;p+=1)h[p]=create_each_block(e,get_each_context(t,m,p));function d(){c=!0,e.set({value:selectValue(l)}),c=!1}function u(a){e.fire("sort",t.value)}return{c(){a=createElement("div"),r=createElement("div"),(s=createElement("div")).innerHTML="<small>Sort By:</small>",i=createText("\r\n    "),n=createElement("div"),o=createElement("div"),l=createElement("select"),(_=createElement("option")).textContent="Default";for(var c=0;c<h.length;c+=1)h[c].c();s.className="control",_.__value="",_.value=_.__value,addListener(l,"change",d),"value"in t||e.root._beforecreate.push(d),addListener(l,"change",u),l.className="is-fullwidth",o.className="select is-small",n.className="control",r.className="field is-grouped",a.className="sorting-filters"},m(e,c){insert(e,a,c),append(a,r),append(r,s),append(r,i),append(r,n),append(n,o),append(o,l),append(l,_);for(var m=0;m<h.length;m+=1)h[m].m(l,null);selectOption(l,t.value)},p(a,r){if(t=r,a.options){m=t.options;for(var s=0;s<m.length;s+=1){const r=get_each_context(t,m,s);h[s]?h[s].p(a,r):(h[s]=create_each_block(e,r),h[s].c(),h[s].m(l,null))}for(;s<h.length;s+=1)h[s].d(1);h.length=m.length}!c&&a.value&&selectOption(l,t.value)},d(e){e&&detachNode(a),destroyEach(h,e),removeListener(l,"change",d),removeListener(l,"change",u)}}}function create_each_block(e,t){var a,r,s,i=t.opt.name;return{c(){a=createElement("option"),r=createText(i),a.__value=s=t.opt.value,a.value=a.__value},m(e,t){insert(e,a,t),append(a,r)},p(e,t){e.options&&i!==(i=t.opt.name)&&setData(r,i),e.options&&s!==(s=t.opt.value)&&(a.__value=s),a.value=a.__value},d(e){e&&detachNode(a)}}}function DataSort(e){init(this,e),this._state=assign(data(),e.data),this._intro=!0,this._handlers.state=[onstate],onstate.call(this,{changed:assignTrue({},this._state),current:this._state}),this._fragment=create_main_fragment(this,this._state),this.root._oncreate.push(()=>{this.fire("update",{changed:assignTrue({},this._state),current:this._state})}),e.target&&(this._fragment.c(),this._mount(e.target,e.anchor),flush(this))}assign(DataSort.prototype,proto);var ViewHOC=createHOC();function has_transition({$settings:e,transition:t}){return void 0!==t?t:e.transition}function targetview({view_type:e,customView:t,_TileView:a,_GridView:r}){var s=t;return"tile"==e?s=a:"grid"==e&&(s=r),s}function data$1(){return{_GridView:GridView,_TileView:TileView,customView:null,iteration_key:"id",Router:null,Model:null,View:null,route_prefix:"",sort_param_index:2,q_param_index:1,offset_param_index:0,limit:20,entity_name:"entries",view_type:"grid",tileItemComponent:null,rowComponent:null,filterComponent:null,has_search:!0,show_search_box:!0,show_filters:!0,search_placeholder:"Search",has_pagination:!0,has_additional_buttons:!1,filter_in_use_class:"is-in-use",filter_not_in_use_class:"is-not-in-use",filter_label_map:{},is_striped:!0,per_row:3,is_loading:!0,is_error:!1,error_message:"",is_paginating:!1,sort:"",q:"",meta:{},data:[],response:[],columns:{},searchStringTransformer:e=>"",responseTransformer:e=>e,requestTransformer:(e,t)=>e.getAll(t),valueTransformers:{},classTransformers:{},styleTransformers:{},visibilityMap:{},cellComponentMap:{},clickableRows:!1}}var methods={init(){this.setCurrentQuery(),this.on("setLimit",e=>{this.set({limit:e.newLimit}),e.currentPage>0?this.fire("paginate",{offset:0}):this.getAll()}),this.on("sort",e=>{let{route_prefix:t,q:a}=this.get();a=a.replace("%",""),this.set({data:[]}),this.getRouter().navigate(t+"0/"+a+"/"+e)}),this.on("paginate",e=>{let{route_prefix:t,q:a,sort:r}=this.get();a=a.replace("%",""),this.getRouter().navigate(t+e.offset+"/"+a+"/"+r)}),this.on("search",e=>{if(""!=e){let{route_prefix:t,sort:a}=this.get();e=e.replace("%",""),this.getRouter().navigate(t+"0/"+e+"/"+a)}}),this.on("resetSearch",()=>{this.getRouter().navigate(this.get().route_prefix)}),this.store.on("state",({changed:e,current:t,previous:a})=>{var{nav:r}=t;r.activeView==this.get().View&&(this.setCurrentQuery(),this.getAll())},{init:!1}),this.getAll()},getRouter(){return Router||this.get().Router},setCurrentQuery(){var{nav:e}=this.store.get(),{q_param_index:t,sort_param_index:a}=this.get(),r=t||1,s=a||2;this.set({q:e&&e.params[r]||"",sort:e&&e.params[s]||""})},getOpts(){var{nav:e}=this.store.get(),{limit:t,searchStringTransformer:a,q_param_index:r,offset_param_index:s,sort_param_index:i}=this.get(),n=e&&e.params&&e.params[r]?e.params[r]:"",o=e&&e.params&&e.params[s]?e.params[s]:0,l=e&&e.params&&e.params[i]?e.params[i]:"";return{offset:o,limit:t,q:a(n),sort:l}},getAll(){var e=this.getOpts();this.set({is_paginating:!0});let{responseTransformer:t,requestTransformer:a,Model:r}=this.get();a(r,e).then(e=>{this.set({meta:e._meta,data:t(e.response),response:e.response,is_paginating:!1,is_loading:!1,is_error:!1})}).catch(e=>{var t="";void 0!==e.response&&void 0!==e.response.records&&(t=e.response.records.userMessage),this.set({is_error:!0,error_message:t,is_paginating:!1,is_loading:!1})})}};function oncreate(){this.on("_forwardEvent",e=>{this.fire(e.name,e.event)}),this.init()}function create_main_fragment$1(e,t){var a,r,s,i,n,o=t.is_paginating&&create_if_block_4(e,t),l=t.has_search&&create_if_block_2(e,t),_=t.meta.sort&&create_if_block_1(e,t),c={target:t.targetview,transition:t.has_transition,iteration_key:t.iteration_key,data:t.data,columns:t.columns,per_row:t.per_row,valueTransformers:t.valueTransformers,classTransformers:t.classTransformers,styleTransformers:t.styleTransformers,visibilityMap:t.visibilityMap,tileItemComponent:t.tileItemComponent,cellComponentMap:t.cellComponentMap,rowComponent:t.rowComponent,clickableRows:t.clickableRows},m=new ViewHOC({root:e.root,store:e.store,data:c});m.on("*",function(t){e.fire("_forwardEvent",t)});var h=t.has_pagination&&create_if_block(e,t);return{c(){o&&o.c(),a=createText("\r\n\r\n\r\n"),l&&l.c(),r=createText("\r\n"),_&&_.c(),s=createText("\r\n\r\n\r\n"),m._fragment.c(),i=createText("\r\n"),h&&h.c(),n=createComment()},m(e,t){o&&o.m(e,t),insert(e,a,t),l&&l.m(e,t),insert(e,r,t),_&&_.m(e,t),insert(e,s,t),m._mount(e,t),insert(e,i,t),h&&h.m(e,t),insert(e,n,t)},p(t,i){i.is_paginating?o||((o=create_if_block_4(e,i)).c(),o.m(a.parentNode,a)):o&&(o.d(1),o=null),i.has_search?l?l.p(t,i):((l=create_if_block_2(e,i)).c(),l.m(r.parentNode,r)):l&&(l.d(1),l=null),i.meta.sort?_?_.p(t,i):((_=create_if_block_1(e,i)).c(),_.m(s.parentNode,s)):_&&(_.d(1),_=null);var c={};t.targetview&&(c.target=i.targetview),t.has_transition&&(c.transition=i.has_transition),t.iteration_key&&(c.iteration_key=i.iteration_key),t.data&&(c.data=i.data),t.columns&&(c.columns=i.columns),t.per_row&&(c.per_row=i.per_row),t.valueTransformers&&(c.valueTransformers=i.valueTransformers),t.classTransformers&&(c.classTransformers=i.classTransformers),t.styleTransformers&&(c.styleTransformers=i.styleTransformers),t.visibilityMap&&(c.visibilityMap=i.visibilityMap),t.tileItemComponent&&(c.tileItemComponent=i.tileItemComponent),t.cellComponentMap&&(c.cellComponentMap=i.cellComponentMap),t.rowComponent&&(c.rowComponent=i.rowComponent),t.clickableRows&&(c.clickableRows=i.clickableRows),m._set(c),i.has_pagination?h?h.p(t,i):((h=create_if_block(e,i)).c(),h.m(n.parentNode,n)):h&&(h.d(1),h=null)},d(e){o&&o.d(e),e&&detachNode(a),l&&l.d(e),e&&detachNode(r),_&&_.d(e),e&&detachNode(s),m.destroy(e),e&&detachNode(i),h&&h.d(e),e&&detachNode(n)}}}function create_if_block_4(e,t){var a,r=new Loader({root:e.root,store:e.store});return{c(){a=createElement("div"),r._fragment.c(),a.className="is-overlay"},m(e,t){insert(e,a,t),r._mount(a,null)},d(e){e&&detachNode(a),r.destroy()}}}function create_if_block_2(e,t){var a,r,s,i={},n={hasSearch:t.show_search_box,hasFilters:t.show_filters,placeholder:t.search_placeholder,q:t.q,filterComponent:t.filterComponent,filter_not_in_use_class:t.filter_not_in_use_class,filter_in_use_class:t.filter_in_use_class,filter_label_map:t.filter_label_map};void 0!==t.meta.filters&&(n.filters=t.meta.filters,i.filters=!0);var o=new DataSearch({root:e.root,store:e.store,data:n,_bind(a,r){var s={};!i.filters&&a.filters&&(t.meta.filters=r.filters,s.meta=t.meta),e._set(s),i={}}});e.root._beforecreate.push(()=>{o._bind({filters:1},o.get())}),o.on("search",function(t){e.fire("search",t)}),o.on("resetSearch",function(t){e.fire("resetSearch",t)});var l=t.has_additional_buttons&&create_if_block_3(e,t);return{c(){a=createElement("div"),r=createElement("div"),o._fragment.c(),s=createText("\r\n"),l&&l.c(),r.className="column",a.className="columns search-area"},m(e,t){insert(e,a,t),append(a,r),o._mount(r,null),append(a,s),l&&l.m(a,null)},p(r,s){t=s;var n={};r.show_search_box&&(n.hasSearch=t.show_search_box),r.show_filters&&(n.hasFilters=t.show_filters),r.search_placeholder&&(n.placeholder=t.search_placeholder),r.q&&(n.q=t.q),r.filterComponent&&(n.filterComponent=t.filterComponent),r.filter_not_in_use_class&&(n.filter_not_in_use_class=t.filter_not_in_use_class),r.filter_in_use_class&&(n.filter_in_use_class=t.filter_in_use_class),r.filter_label_map&&(n.filter_label_map=t.filter_label_map),!i.filters&&r.meta&&(n.filters=t.meta.filters,i.filters=void 0!==t.meta.filters),o._set(n),i={},t.has_additional_buttons?l||((l=create_if_block_3(e,t)).c(),l.m(a,null)):l&&(l.d(1),l=null)},d(e){e&&detachNode(a),o.destroy(),l&&l.d()}}}function create_if_block_3(e,t){var a,r=e._slotted.additionalButtons;return{c(){(a=createElement("div")).className="column is-narrow"},m(e,t){insert(e,a,t),r&&append(a,r)},d(e){e&&detachNode(a),r&&reinsertChildren(a,r)}}}function create_if_block_1(e,t){var a={options:t.meta.sort,sort:t.sort},r=new DataSort({root:e.root,store:e.store,data:a});return r.on("sort",function(t){e.fire("sort",t)}),{c(){r._fragment.c()},m(e,t){r._mount(e,t)},p(e,t){var a={};e.meta&&(a.options=t.meta.sort),e.sort&&(a.sort=t.sort),r._set(a)},d(e){r.destroy(e)}}}function create_if_block(e,t){var a={meta:t.meta,entityName:t.entity_name},r=new Pagination({root:e.root,store:e.store,data:a});return r.on("paginate",function(t){e.fire("paginate",t)}),r.on("setLimit",function(t){e.fire("setLimit",t)}),{c(){r._fragment.c()},m(e,t){r._mount(e,t)},p(e,t){var a={};e.meta&&(a.meta=t.meta),e.entity_name&&(a.entityName=t.entity_name),r._set(a)},d(e){r.destroy(e)}}}function DataList(e){init(this,e),this._state=assign(assign(this.store._init(["settings"]),data$1()),e.data),this.store._add(this,["settings"]),this._recompute({$settings:1,transition:1,view_type:1,customView:1,_TileView:1,_GridView:1},this._state),this._intro=!0,this._handlers.destroy=[removeFromStore],this._slotted=e.slots||{},this._fragment=create_main_fragment$1(this,this._state),this.root._oncreate.push(()=>{oncreate.call(this),this.fire("update",{changed:assignTrue({},this._state),current:this._state})}),e.target&&(this._fragment.c(),this._mount(e.target,e.anchor),flush(this))}assign(DataList.prototype,proto),assign(DataList.prototype,methods),DataList.prototype._recompute=function(e,t){(e.$settings||e.transition)&&this._differs(t.has_transition,t.has_transition=has_transition(t))&&(e.has_transition=!0),(e.view_type||e.customView||e._TileView||e._GridView)&&this._differs(t.targetview,t.targetview=targetview(t))&&(e.targetview=!0)};export{DataList as a};
//# sourceMappingURL=chunk-988ddd89.js.map
