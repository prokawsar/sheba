{"version":3,"file":"chunk-92dc7f50.js","sources":["../../../src/utils/rAF.js","../../../src/components/helpers/PageTabBar.html"],"sourcesContent":["export default window.requestAnimationFrame ||\r\n  window.webkitRequestAnimationFrame ||\r\n  window.mozRequestAnimationFrame ||\r\n  window.oRequestAnimationFrame ||\r\n  window.msRequestAnimationFrame ||\r\n  function ( /* function FrameRequestCallback */ callback, /* DOMElement Element */ element) {\r\n\r\n    window.setTimeout(callback, 1000 / 60);\r\n\r\n  };","<div class=\"tabbar\" ref:tabbar>\r\n  <div class=\"tabs is-right is-toggle \">\r\n    <ul ref:tabs>\r\n\r\n      <slot></slot>\r\n\r\n      <li class=\"more-link dropdown is-right {_show_dropdown ? 'is-active' : ''} {_show_more_link ? '' : 'is-hidden'}\">\r\n        <a class=\"dropdown-trigger\" on:click=\"fire('showDropdown', event)\" href=\"show\">\r\n          <Icon size=\"small\" icon=\"chevron-down\" />&nbsp;\r\n        </a>\r\n        <div class=\"dropdown-menu\">\r\n          <ul class=\"dropdown-content\" ref:overflow>\r\n\r\n          </ul>\r\n        </div>\r\n      </li>\r\n\r\n    </ul>\r\n  </div>\r\n</div>\r\n\r\n<script>\r\n  import { Icon } from '@kws3/helpers';\r\n  import rAF from '../../utils/rAF';\r\n\r\n  export default {\r\n    components: {\r\n      Icon\r\n    },\r\n    data() {\r\n      return {\r\n        _show_dropdown: false,\r\n        _show_more_link: false,\r\n        getTotalSpace(tabbar) {\r\n          var totalSpace = tabbar.parentNode.parentNode.parentNode.parentNode.clientWidth;\r\n          return totalSpace;\r\n        },\r\n        getAvailableSpace(tabbar, totalSpace) {\r\n          var mainParent = tabbar.parentNode.parentNode.parentNode.parentNode,\r\n          availableSpace = totalSpace,\r\n          middleItemWidth = mainParent.children[1].clientWidth;\r\n\r\n          availableSpace -= mainParent.children[0].clientWidth;\r\n          availableSpace -= middleItemWidth > 50 ? middleItemWidth : 50;\r\n          return availableSpace;\r\n        }\r\n      }\r\n    },\r\n    oncreate() {\r\n      this.pollForRender();\r\n    },\r\n    methods: {\r\n      pollForRender(){\r\n        if(this.refs.tabs && typeof this.refs.tabs != 'undefined'){\r\n          this.init()\r\n        }else{\r\n          setTimeout(() => {\r\n            this.pollForRender();\r\n          }, 200);\r\n        }\r\n      },\r\n      init(){\r\n        this.tabbar = this.refs.tabbar;\r\n        this.tabs = this.refs.tabs;\r\n        if(this.tabs && typeof this.tabs != 'undefined'){\r\n          this.tab_items = [].slice.call(this.tabs.querySelectorAll('li:not(.more-link)'));\r\n\r\n          for (var i = this.tab_items.length - 1; i >= 0; i--) {\r\n            var el = this.tab_items[i];\r\n            this.attachClickEvents(el);\r\n          }\r\n\r\n          var {getTotalSpace, getAvailableSpace} = this.get();\r\n\r\n          this.overflow = this.refs.overflow;\r\n\r\n          this.totalSpace = getTotalSpace(this.tabbar);\r\n\r\n          this.windowResizeHandler = () => {\r\n            rAF(() => {\r\n              if(!this.tabbar.parentNode) return;\r\n              //hide tabs while doing calculations to avoid flickering\r\n              this.tabs.style.visibility = 'hidden';\r\n\r\n              //runs when window is being sized up\r\n              var totalSpace = getTotalSpace(this.tabbar);\r\n              if (totalSpace > this.totalSpace) {\r\n                //we are resizing up, so show all hidden tabs to start with\r\n                var tab_items = [].slice.call(this.tabs.querySelectorAll('li:not(.more-link)'));\r\n                for (var i = tab_items.length - 1; i >= 0; i--) {\r\n                  var el = tab_items[i];\r\n                  el.classList.remove('is-hidden');\r\n                }\r\n                this.set({ _show_more_link: false });\r\n              }\r\n\r\n              //store current width for next check\r\n              this.totalSpace = getTotalSpace(this.tabbar);\r\n\r\n              var usedSpace = this.tabs.clientWidth;\r\n              var availableSpace = getAvailableSpace(this.tabbar, getTotalSpace(this.tabbar));\r\n              if (usedSpace > availableSpace) {\r\n                this.set({ _show_more_link: true });\r\n                var found = false;\r\n                for (var i = this.tab_items.length - 1; i >= 0; i--) {\r\n                  var el = this.tab_items[i];\r\n                  if (!el.classList.contains('is-hidden')) {\r\n                    el.classList.add('is-hidden');\r\n                    found = true;\r\n                    break;\r\n                  }\r\n                }\r\n\r\n                //populate the dropdown menu with hidden tabs\r\n                this.populateOverflow();\r\n\r\n                if (found) { //loop if there are more tabs\r\n                  this.windowResizeHandler();\r\n                }\r\n              }\r\n\r\n              //show tabs after all calculations and movements\r\n              this.tabs.style.visibility = 'visible';\r\n\r\n            });\r\n          }\r\n\r\n          this.outsideClickHandler = (event) => {\r\n            var isClickInside = this.overflow.contains(event.target);\r\n            if (!isClickInside && this.get()._show_dropdown) {\r\n              this.set({ _show_dropdown: false });\r\n              window.removeEventListener('click', this.outsideClickHandler);\r\n            }\r\n          }\r\n\r\n\r\n          window.addEventListener('resize', this.windowResizeHandler, false);\r\n          this.windowResizeHandler();\r\n\r\n          this.on('showDropdown', (e) => {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n            window.addEventListener('click', this.outsideClickHandler, false);\r\n            this.set({ _show_dropdown: true });\r\n          });\r\n\r\n          this.on('destroy', () => {\r\n            window.removeEventListener('resize', this.windowResizeHandler);\r\n            window.removeEventListener('click', this.outsideClickHandler);\r\n          });\r\n        }\r\n      },\r\n      populateOverflow() {\r\n        this.overflow.innerHTML = \"\";\r\n        var hiddens = [].slice.call(this.tabs.querySelectorAll('li:not(.more-link).is-hidden'));\r\n        for (var i = 0; i < hiddens.length; i++) {\r\n          var clone = hiddens[i].cloneNode(true);\r\n          clone.classList.remove('is-hidden');\r\n          this.overflow.appendChild(clone);\r\n          this.attachClickEvents(clone, true);\r\n        }\r\n      },\r\n      attachClickEvents(elem, set){\r\n        elem.addEventListener('click', () => {\r\n          if(!elem.classList.contains('is-active')){\r\n            set && this.set({ _show_dropdown: false });\r\n            setTimeout(() => this.windowResizeHandler(), 1);\r\n          }\r\n        });\r\n      }\r\n    }\r\n  }\r\n</script>"],"names":["window","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","msRequestAnimationFrame","callback","element","setTimeout","_show_dropdown","_show_more_link","getTotalSpace","tabbar","parentNode","clientWidth","[object Object]","totalSpace","mainParent","availableSpace","middleItemWidth","children","this","refs","tabs","init","pollForRender","tab_items","slice","call","querySelectorAll","i","length","el","attachClickEvents","getAvailableSpace","get","overflow","windowResizeHandler","rAF","style","visibility","classList","remove","set","found","contains","add","populateOverflow","outsideClickHandler","event","target","removeEventListener","addEventListener","on","e","preventDefault","stopPropagation","innerHTML","hiddens","clone","cloneNode","appendChild","elem","fire"],"mappings":"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"}