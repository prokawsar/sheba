var K_ENV="prod",K_ENV_DEV="dev",K_ENV_TEST="test",K_ENV_PROD="prod";import{w as addListener,a as append,b as assign,c as assignTrue,d as createElement,f as createText,A as destroyEach,g as detachNode,h as flush,i as init,j as insert,l as proto,x as removeListener,y as setAttribute,B as setData}from"./chunk-4772d5c0.js";function makeKeyDefinition(e){return function(t,s){function a(t){(t.which||t.keyCode)===e&&s(t)}return t.addEventListener("keydown",a,!1),{destroy(){t.removeEventListener("keydown",a,!1)}}}}var enter=makeKeyDefinition(13),escape=makeKeyDefinition(27),downarrow=makeKeyDefinition(40),uparrow=makeKeyDefinition(38),rAF=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,t){window.setTimeout(e,1e3/60)},win=window,doc=document,dropdownId="searchableselect-dropdown-container";function items({data:e,filter:t,searchKey:s}){t=t.toLowerCase();var a=e||[];s=s;return a&&a instanceof Array?a=a.slice().filter(function(e){if("object"!=typeof e)return e.toLowerCase().indexOf(t)>-1;if(s){if("string"==typeof e[s]&&e[s].toLowerCase().indexOf(t)>-1)return!0}else for(var a in e)if("string"==typeof e[a]&&e[a].toLowerCase().indexOf(t)>-1)return!0}):null}function data(){return{_name:"",value:"",filter:"",style:"",classes:"",dd_class:"",cy:"",scrollTarget:null,searchKey:null,searchValue:null,data:[],highlighted:-1,selected:-1,open:!1,disabled:!1}}var methods={open(){var{disabled:e}=this.get();e||(this.set({open:!0}),this.updateBounds())},close(){this.set({open:!1})},select(e,t){var{searchKey:s,searchValue:a,items:n}=this.get();e?this.set({value:e[a],_name:e[s],selected:+t,highlighted:+t}):this.set({value:"",_name:"",selected:-1}),this.set({filter:""}),this.close(),this.updateBounds()},updateBounds(){var e=this.refs.searchableselect,{open:t}=this.get();if(this.refs&&this.refs.dropdown){var s=this.refs.dropdown.querySelector(".selecting"),a=this.refs.dropdown.querySelector(".selected"),n=e.getBoundingClientRect();this.dropdown.style.width=n.width+"px";var r=this.dropdown;if(t){null!=s&&(s.offsetTop>358?r.scrollTop=s.offsetTop-358:r.scrollTop=0),null!=a&&(a.offsetTop>358?r.scrollTop=a.offsetTop-358:r.scrollTop=0),r.style.left=n.left+"px";var o=n.bottom,i=win.innerHeight;o+r.offsetHeight>i?(r.style.bottom=i-(n.top-3)+"px",r.style.top="auto"):(r.style.top=o+"px",r.style.bottom="auto")}else r.style.left="-9999px"}}};function oncreate(){var e=this;let t=e.refs.searchableselect,s=t.querySelector(".name"),a=t.querySelector("input");a.style.display="none",s.style.display="block",e.on("state",({changed:t,current:n})=>{if(t.open){let{open:t,value:r}=n;t?(a.style.display="block",s.style.display="none",a.focus(),a.select()):(a.style.display="none",s.style.display="block",""===r&&e.set({highlighted:-1,selected:-1}))}});var{data:n}=e.get();n||e.set({data:[]});var r=this.refs.searchableselect.querySelector(".dropdown");e.dropdown=r;var o=doc.getElementById(dropdownId);o||((o=doc.createElement("div")).id=dropdownId,o.className="searchableselect",doc.body.appendChild(o)),o.appendChild(r);e.refs.dropdown.querySelector(".selecting");e.on("uparrow",function(t){t.stopPropagation(),t.stopImmediatePropagation(),t.preventDefault(),e.set({selected:-1});var{highlighted:s,items:a}=e.get();if(!(s<=-1)){do{s--}while(-1==s);s=Math.max(-1,s),e.set({highlighted:s}),e.updateBounds()}}),e.on("downarrow",function(t){t.stopPropagation(),t.stopImmediatePropagation(),t.preventDefault(),e.set({selected:-1});var{open:s,highlighted:a,items:n}=e.get();if(!(a>=n.length-1)){s||e.open();do{a++}while(a==n.length);a=Math.min(n.length,a),e.set({highlighted:a}),e.updateBounds()}}),e.on("enter",function(t){t.stopPropagation(),t.stopImmediatePropagation(),t.preventDefault();var{open:s,highlighted:a,items:n}=e.get();-1!==a&&s&&e.select(n[a],a),a<0&&e.select(null)}),e.on("escape",function(t){t.stopPropagation(),t.stopImmediatePropagation(),t.preventDefault(),e.close()}),e.clickHandler=function(t){t.stopImmediatePropagation();var s=e.refs.searchableselect;if(s){var a=s.querySelector(".dropdown"),n=t.target;s.contains(n)||n===a||e.set({open:!1})}},e.scrollHandler=function(t){t.stopImmediatePropagation(),t.stopPropagation();var{open:s,scrollTarget:a}=e.get();a?"string"==typeof a&&(a=doc.getElementById(a)):a=win,s&&t.target==a&&e.close()},e.on("update",function({changed:t,current:s}){if(t.open){var{open:a,scrollTarget:n,value:r}=s;n?"string"==typeof n&&(n=doc.getElementById(n)):n=win,e.updateBounds(),a?(doc.addEventListener("click",e.clickHandler),n.addEventListener("scroll",e.scrollHandler)):(doc.removeEventListener("click",e.clickHandler),n.removeEventListener("scroll",e.scrollHandler))}})}function ondestroy(){this.refs.searchableselect.removeEventListener("click",this.clickHandler),win.removeEventListener("click",this.clickHandler),doc.removeEventListener("scroll",this.scrollHandler),this.dropdown&&this.dropdown.parentNode.removeChild(this.dropdown);var e=doc.getElementById(dropdownId);e&&0==e.childNodes.length&&e.parentNode.removeChild(e)}function onupdate({changed:e,current:t}){if(e.value){var{value:s}=t;if(""===s)this.set({_name:"",filter:"",highlighted:-1,selected:-1});else{let{searchKey:e,searchValue:n,data:r}=t;var a;for(let t in r)if(r[t][n]==s){a=r[t][e];break}this.set({_name:a,value:s})}}if(e.items){var{_name:a,searchKey:n,items:r}=t;for(let e in r)if(r[e][n]==a){this.set({selected:e,highlighted:e});break}}}function click_handler(e){const{component:t,ctx:s}=this._svelte;t.select(s.item,s.i)}function get_each_context(e,t,s){const a=Object.create(e);return a.item=t[s],a.i=s,a}function create_main_fragment(e,t){var s,a,n,r,o,i,l,c,d,h,p,u,f,m,g,y,v,w,_=t._name||t.placeholder,b=!1;function k(t){e.close()}function E(){b=!0,e.set({filter:i.value}),b=!1}function x(t){e.open()}function L(t){e.select(null)}window.addEventListener("resize",k);for(var T=t.items,N=[],K=0;K<T.length;K+=1)N[K]=create_each_block(e,get_each_context(t,T,K));function S(t){e.open()}return{c(){s=createElement("div"),a=createElement("span"),n=createElement("span"),r=createText(_),o=createText("\n\n  "),i=createElement("input"),p=createText("\n\n\n  "),u=createElement("ul"),f=createElement("li"),m=createText(t.placeholder),y=createText("\n    ");for(var b=0;b<N.length;b+=1)N[b].c();n.className="name",a.className="name-wrapper",addListener(i,"input",E),addListener(i,"focus",x),l=enter.call(e,i,function(t){e.fire("enter",t)}),c=uparrow.call(e,i,function(t){e.fire("uparrow",t)}),d=downarrow.call(e,i,function(t){e.fire("downarrow",t)}),h=escape.call(e,i,function(t){e.fire("escape",t)}),setAttribute(i,"type","text"),addListener(f,"click",L),f.className=g=t.selected&&t.highlighted<0?"selected":"",u.className=v="dropdown "+(t.open?" open ":" ")+" "+t.dd_class,u.dataset.cy=t.cy,addListener(s,"click",S),s.className=w="searchableselect input is-shadowless "+(t.disabled?" is-disabled ":" ")+" "+t.classes,s.style.cssText=t.style,s.dataset.cy="select-container"},m(l,c){insert(l,s,c),append(s,a),append(a,n),append(n,r),append(s,o),append(s,i),i.value=t.filter,append(s,p),append(s,u),append(u,f),append(f,m),append(u,y);for(var d=0;d<N.length;d+=1)N[d].m(u,null);e.refs.dropdown=u,e.refs.searchableselect=s},p(t,a){if((t._name||t.placeholder)&&_!==(_=a._name||a.placeholder)&&setData(r,_),!b&&t.filter&&(i.value=a.filter),t.placeholder&&setData(m,a.placeholder),(t.selected||t.highlighted)&&g!==(g=a.selected&&a.highlighted<0?"selected":"")&&(f.className=g),t.highlighted||t.selected||t.items||t.searchKey){T=a.items;for(var n=0;n<T.length;n+=1){const s=get_each_context(a,T,n);N[n]?N[n].p(t,s):(N[n]=create_each_block(e,s),N[n].c(),N[n].m(u,null))}for(;n<N.length;n+=1)N[n].d(1);N.length=T.length}(t.open||t.dd_class)&&v!==(v="dropdown "+(a.open?" open ":" ")+" "+a.dd_class)&&(u.className=v),t.cy&&(u.dataset.cy=a.cy),(t.disabled||t.classes)&&w!==(w="searchableselect input is-shadowless "+(a.disabled?" is-disabled ":" ")+" "+a.classes)&&(s.className=w),t.style&&(s.style.cssText=a.style)},d(t){window.removeEventListener("resize",k),t&&detachNode(s),removeListener(i,"input",E),removeListener(i,"focus",x),l.destroy(),c.destroy(),d.destroy(),h.destroy(),removeListener(f,"click",L),destroyEach(N,t),e.refs.dropdown===u&&(e.refs.dropdown=null),removeListener(s,"click",S),e.refs.searchableselect===s&&(e.refs.searchableselect=null)}}}function create_each_block(e,t){var s,a,n,r,o=t.item[t.searchKey];return{c(){s=createElement("li"),a=createText(o),n=createText("\n    "),s._svelte={component:e,ctx:t},addListener(s,"click",click_handler),s.className=r=(t.highlighted==t.i?" selecting ":" ")+" "+(t.selected==t.i?"selected ":" ")},m(e,t){insert(e,s,t),append(s,a),append(s,n)},p(e,n){t=n,(e.items||e.searchKey)&&o!==(o=t.item[t.searchKey])&&setData(a,o),s._svelte.ctx=t,(e.highlighted||e.selected)&&r!==(r=(t.highlighted==t.i?" selecting ":" ")+" "+(t.selected==t.i?"selected ":" "))&&(s.className=r)},d(e){e&&detachNode(s),removeListener(s,"click",click_handler)}}}function SearchableSelect(e){init(this,e),this.refs={},this._state=assign(data(),e.data),this._recompute({data:1,filter:1,searchKey:1},this._state),this._intro=!0,this._handlers.update=[onupdate],this._handlers.destroy=[ondestroy],this._fragment=create_main_fragment(this,this._state),this.root._oncreate.push(()=>{oncreate.call(this),this.fire("update",{changed:assignTrue({},this._state),current:this._state})}),e.target&&(this._fragment.c(),this._mount(e.target,e.anchor),flush(this))}assign(SearchableSelect.prototype,proto),assign(SearchableSelect.prototype,methods),SearchableSelect.prototype._recompute=function(e,t){(e.data||e.filter||e.searchKey)&&this._differs(t.items,t.items=items(t))&&(e.items=!0)};export{SearchableSelect as a,rAF as b};
//# sourceMappingURL=chunk-97880b15.js.map
