var K_ENV="prod",K_ENV_DEV="dev",K_ENV_TEST="test",K_ENV_PROD="prod";import{w as addListener,a as append,b as assign,d as createElement,e as createFragment,f as createText,g as detachNode,h as flush,i as init,j as insert,l as proto,m as removeFromStore,x as removeListener,y as setAttribute,B as setData,n as Icon,E as Notification,D as Panel,q as ViewScaffold,r as PageTitle}from"./chunk-ce2fee6f.js";import{a as Router}from"./chunk-0860a2de.js";import{b as SubmitButton}from"./chunk-d9e89df1.js";import{a as Remedies}from"./chunk-dc7fa8bb.js";function user_role({$user:e}){return e&&e.role}function data(){return{is_loading:!1,is_error:!1,error_message:"",selected_symptom:"",data:{name:""},tracker:{saving:!1,saved:!1,error:!1},page:{title:"Add Remedy",icon:"vcard-o",icon_badge:"plus"},valid:!1}}var methods={reset(){this.set({data:this.getDataObj()})},select_symptom(e){this.set({selected_symptom:e})},addNew(e){e.preventDefault();var{data:t,valid:r}=this.get();this.set({tracker:{saving:!0,saved:!1,error:!1}}),Remedies.create(t).then(e=>{this.set({tracker:{saving:!1,saved:!0,error:!1},data:e.response}),setTimeout(()=>{this.set({tracker:{saved:!1}}),Router.navigate("remedies")},1500)}).catch(e=>{"406"==e.response.records.errorCode?this.set({error_message:e.response.records.userMessage}):this.set({error_message:"There was an error adding remedy"}),this.set({tracker:{saving:!1,saved:!1,error:!0}}),setTimeout(()=>{this.set({tracker:{error:!1}})},3e3)})},getDataObj:()=>({name:""})};function create_main_fragment(e,t){var r,a,s,o,n,d,i,l,c,m,p,_,u,g,f,h,v,k,y,b,N,E=!1,x={},T=new Icon({root:e.root,store:e.store,data:{icon:"long-arrow-left",size:"small"}}),R={page:t.page},w=new PageTitle({root:e.root,store:e.store,slots:{default:createFragment()},data:R}),A=t.tracker.error&&create_if_block(e,t);function D(){E=!0,t.data.name=g.value,e.set({data:t.data}),E=!1}var j={classes:"is-primary is-pulled-right",icon:"plus",icon_size:"small",text:"Add Remedy"};void 0!==t.tracker&&(j.tracker=t.tracker,x.tracker=!0);var F=new SubmitButton({root:e.root,store:e.store,data:j,_bind(t,r){var a={};!x.tracker&&t.tracker&&(a.tracker=r.tracker),e._set(a),x={}}});e.root._beforecreate.push(()=>{F._bind({tracker:1},F.get())});var S=new Panel({root:e.root,store:e.store,slots:{default:createFragment()},data:{title:"Remedy Details",has_toolbar:!0}});function V(t){e.addNew(t)}var L={is_loading:t.is_loading,is_error:t.is_error,error_message:t.error_message},P=new ViewScaffold({root:e.root,store:e.store,slots:{default:createFragment()},data:L});return{c(){r=createElement("div"),a=createElement("a"),T._fragment.c(),s=createText("\r\n      "),(o=createElement("span")).textContent="Back to All Remedies",w._fragment.c(),n=createText("\r\n\r\n  "),A&&A.c(),d=createText("\r\n\r\n      "),i=createElement("form"),l=createElement("div"),c=createElement("div"),m=createElement("div"),p=createElement("p"),(_=createElement("label")).textContent="Name",u=createText("\r\n                  "),g=createElement("input"),f=createText("\r\n\r\n          "),h=createElement("div"),v=createElement("div"),k=createElement("div"),y=createElement("p"),(b=createElement("label")).textContent="Â ",N=createText("\r\n                  "),F._fragment.c(),S._fragment.c(),P._fragment.c(),a.className="button is-info is-pulled-right",a.href="#remedies",_.className="label",addListener(g,"input",D),g.className="input is-medium",setAttribute(g,"type","text"),g.required=!0,p.className="control",m.className="field",c.className="column",l.className="columns",b.className="label",y.className="control",k.className="field",v.className="column",h.className="columns",addListener(i,"submit",V),r.className="page-content"},m(e,E){insert(e,r,E),append(w._slotted.default,a),T._mount(a,null),append(a,s),append(a,o),w._mount(r,null),append(r,n),A&&A.m(P._slotted.default,null),append(P._slotted.default,d),append(P._slotted.default,i),append(S._slotted.default,l),append(l,c),append(c,m),append(m,p),append(p,_),append(p,u),append(p,g),g.value=t.data.name,append(S._slotted.default,f),append(S._slotted.default,h),append(h,v),append(v,k),append(k,y),append(y,b),append(y,N),F._mount(y,null),S._mount(i,null),P._mount(r,null)},p(r,a){t=a;var s={};r.page&&(s.page=t.page),w._set(s),t.tracker.error?A?A.p(r,t):((A=create_if_block(e,t)).c(),A.m(d.parentNode,d)):A&&(A.d(1),A=null),!E&&r.data&&(g.value=t.data.name);var o={};!x.tracker&&r.tracker&&(o.tracker=t.tracker,x.tracker=void 0!==t.tracker),F._set(o),x={};var n={};r.is_loading&&(n.is_loading=t.is_loading),r.is_error&&(n.is_error=t.is_error),r.error_message&&(n.error_message=t.error_message),P._set(n)},d(e){e&&detachNode(r),T.destroy(),w.destroy(),A&&A.d(),removeListener(g,"input",D),F.destroy(),S.destroy(),removeListener(i,"submit",V),P.destroy()}}}function create_if_block(e,t){var r,a=new Notification({root:e.root,store:e.store,slots:{default:createFragment()},data:{type:"danger"}});return{c(){r=createText(t.error_message),a._fragment.c()},m(e,t){append(a._slotted.default,r),a._mount(e,t)},p(e,t){e.error_message&&setData(r,t.error_message)},d(e){a.destroy(e)}}}function AddRemedy(e){init(this,e),this._state=assign(assign(this.store._init(["user"]),data()),e.data),this.store._add(this,["user"]),this._recompute({$user:1},this._state),this._intro=!0,this._handlers.destroy=[removeFromStore],this._fragment=create_main_fragment(this,this._state),e.target&&(this._fragment.c(),this._mount(e.target,e.anchor),flush(this))}assign(AddRemedy.prototype,proto),assign(AddRemedy.prototype,methods),AddRemedy.prototype._recompute=function(e,t){e.$user&&this._differs(t.user_role,t.user_role=user_role(t))&&(e.user_role=!0)};export default AddRemedy;
//# sourceMappingURL=AddRemedy.js.map
