{"version":3,"file":"AddPatient.js","sources":["../../../src/components/views/patients/AddPatient.html"],"sourcesContent":["<div class=\"page-content\">\r\n\r\n  <PageTitle page=\"{page}\">\r\n    <a class=\"button is-info is-pulled-right\" href=\"#patients\">\r\n      <Icon icon=\"long-arrow-left\" size=\"small\" />\r\n      <span>Back to All Patients</span>\r\n    </a>\r\n  </PageTitle>\r\n\r\n  <ViewScaffold {is_loading} {is_error} {error_message}>\r\n\r\n    {#if tracker.error}\r\n    <Notification type=\"danger\">\r\n      {error_message}\r\n    </Notification>\r\n    {/if}\r\n\r\n    <form on:submit=\"addNew(event)\">\r\n      <Panel title=\"Patient Details\">\r\n        <div class=\"columns\">\r\n          <div class=\"column\">\r\n\r\n            <div class=\"field\">\r\n              <p class=\"control\">\r\n                <label class=\"label\">Name</label>\r\n                <input class=\"input\" type=\"text\" required bind:value=\"data.name\" />\r\n              </p>\r\n            </div>\r\n            <div class=\"field\">\r\n              <p class=\"control\">\r\n                <label class=\"label\">Phone</label>\r\n                <input class=\"input\" type=\"text\" bind:value=\"data.phone\" />\r\n              </p>\r\n            </div>\r\n\r\n            <div class=\"field\">\r\n              <div class=\"control\">\r\n\r\n                <label class=\"label\">Gender</label>\r\n                <label class=\"radio\">\r\n                  <input type=\"radio\" bind:group=\"data.gender\" value=\"m\"> Male\r\n                </label>\r\n                <label class=\"radio\">\r\n                  <input type=\"radio\" bind:group=\"data.gender\" value=\"f\"> Female\r\n                </label>\r\n              </div>\r\n            </div>\r\n\r\n          </div>\r\n          <div class=\"column\">\r\n            <div class=\"field\">\r\n              <p class=\"control\">\r\n                <label class=\"label\">Age</label>\r\n                <input class=\"input\" type=\"number\" required bind:value=\"data.age\" autocomplete=\"off\" />\r\n              </p>\r\n            </div>\r\n            <div class=\"field\">\r\n              <p class=\"control\">\r\n                <label class=\"label\">Address</label>\r\n                <input class=\"input\" type=\"text\" bind:value=\"data.address\" autocomplete=\"off\" />\r\n              </p>\r\n            </div>\r\n            <div class=\"field\">\r\n              <p class=\"control\">\r\n                <label class=\"label\">&nbsp;</label>\r\n                <SubmitButton classes=\"is-primary is-pulled-right\" icon=\"plus\" icon_size=\"small\" text=\"Create Patient\" bind:tracker />\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </Panel>\r\n    </form>\r\n\r\n\r\n  </ViewScaffold>\r\n</div>\r\n\r\n<script>\r\n  import Model from '../../../models/patients';\r\n  import Router from '../../../services/router';\r\n  import { Icon, Notification, Panel } from '@kws3/helpers';\r\n  import { SubmitButton } from '@kws3/buttons';\r\n\r\n  export default {\r\n    components: {\r\n      ViewScaffold: '../../helpers/ViewScaffold.html',\r\n      PageTitle: '../../helpers/PageTitle.html',\r\n      Panel, Icon, Notification, SubmitButton\r\n    },\r\n\r\n    data() {\r\n      return {\r\n        is_loading: false,\r\n        is_error: false,\r\n        error_message: '',\r\n        data: {\r\n          name: '',\r\n          phone: '',\r\n          address: '',\r\n          gender: ''\r\n        },\r\n        tracker: {\r\n          saving: false,\r\n          saved: false,\r\n          error: false,\r\n        },\r\n        page: {\r\n          title: 'Add Patient',\r\n          icon: 'vcard-o',\r\n          icon_badge: 'plus'\r\n        },\r\n        valid:false\r\n      }\r\n    },\r\n    computed: {\r\n      user_role: ({ $user }) => $user && $user.role,\r\n    },\r\n    methods: {\r\n      addNew(e) {\r\n        e.preventDefault();\r\n\r\n        var { data, valid }  = this.get();\r\n\r\n        this.set({\r\n          tracker: {\r\n            saving: true,\r\n            saved: false,\r\n            error: false\r\n          }\r\n        });\r\n\r\n        Model.create(data)\r\n        .then( (r) => {\r\n          this.set({\r\n            tracker: {\r\n              saving: false,\r\n              saved: true,\r\n              error: false\r\n            },\r\n            data: r.response,\r\n          });\r\n\r\n          setTimeout( () => {\r\n            this.set({ tracker: { saved: false } });\r\n            Router.navigate('patients');\r\n          }, 1500);\r\n\r\n        })\r\n        .catch( (r) => {\r\n          if (r.response.records.errorCode == '406') {\r\n            this.set({error_message: r.response.records.userMessage});\r\n          }else{\r\n            this.set({error_message: 'There was an error adding patient'});\r\n          }\r\n          this.set({\r\n            tracker: {\r\n              saving: false,\r\n              saved: false,\r\n              error: true\r\n            }\r\n          });\r\n\r\n          setTimeout( () => {\r\n            this.set({ tracker: { error: false } });\r\n          }, 3000);\r\n\r\n        });\r\n      }\r\n    }\r\n  }\r\n\r\n</script>"],"names":["$user","role","is_loading","is_error","error_message","data","name","phone","address","gender","tracker","saving","saved","error","page","title","icon","icon_badge","valid","[object Object]","e","preventDefault","this","get","set","Model","create","then","r","response","setTimeout","Router","navigate","catch","records","errorCode","userMessage","age","addNew","event"],"mappings":"4iBAmFA,oBAgCkBA,MAAEA,WAAYA,GAASA,EAAMC,qBAxBzC,MAAO,CACLC,YAAY,EACZC,UAAU,EACVC,cAAe,GACfC,KAAM,CACJC,KAAM,GACNC,MAAO,GACPC,QAAS,GACTC,OAAQ,IAEVC,QAAS,CACPC,QAAQ,EACRC,OAAO,EACPC,OAAO,GAETC,KAAM,CACJC,MAAO,cACPC,KAAM,UACNC,WAAY,QAEdC,OAAM,eAMD,CACPC,OAAOC,GACLA,EAAEC,iBAEF,IAAIhB,KAAEA,EAAIa,MAAEA,GAAWI,KAAKC,MAE5BD,KAAKE,IAAI,CACPd,QAAS,CACPC,QAAQ,EACRC,OAAO,EACPC,OAAO,KAIXY,MAAMC,OAAOrB,GACZsB,KAAOC,IACNN,KAAKE,IAAI,CACPd,QAAS,CACPC,QAAQ,EACRC,OAAO,EACPC,OAAO,GAETR,KAAMuB,EAAEC,WAGVC,WAAY,KACVR,KAAKE,IAAI,CAAEd,QAAS,CAAEE,OAAO,KAC7BmB,OAAOC,SAAS,aACf,QAGJC,MAAQL,IAC6B,OAAhCA,EAAEC,SAASK,QAAQC,UACrBb,KAAKE,IAAI,CAACpB,cAAewB,EAAEC,SAASK,QAAQE,cAE5Cd,KAAKE,IAAI,CAACpB,cAAe,sCAE3BkB,KAAKE,IAAI,CACPd,QAAS,CACPC,QAAQ,EACRC,OAAO,EACPC,OAAO,KAIXiB,WAAY,KACVR,KAAKE,IAAI,CAAEd,QAAS,CAAEG,OAAO,MAC5B,+QAlKOC,kGASXJ,QAAa,iDAcgDL,KAAKC,4DAMdD,KAAKE,wDAShBF,KAAKI,sDAGLJ,KAAKI,4DAUiBJ,KAAKgC,uEAMhBhC,KAAKG,wJAM0DE,uBAAAA,sWAhDvG4B,OAAOC,wBARXrC,sBAAaC,yBAAWC,8qGAgB6BC,KAAKC,uFAMdD,KAAKE,kHAShBF,KAAKI,+EAGLJ,KAAKI,iHAUiBJ,KAAKgC,sFAMhBhC,KAAKG,iKAzD9CM,mBASXJ,QAAQG,qHAcqDR,KAAKC,6BAMdD,KAAKE,wCAShBF,KAAKI,yCAGLJ,KAAKI,gCAUiBJ,KAAKgC,6BAMhBhC,KAAKG,uDAM0DE,8BAAAA,iEAxD3GR,sCAAaC,8CAAWC,2mBAIlCA,uHAAAA"}