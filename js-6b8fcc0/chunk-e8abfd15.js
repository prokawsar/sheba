var K_ENV="prod",K_ENV_DEV="dev",K_ENV_TEST="test",K_ENV_PROD="prod";import{A as addListener,a as append,b as assign,c as assignTrue,u as createComment,d as createElement,f as createText,v as destroyEach,g as detachNode,h as flush,i as init,j as insert,l as proto,B as removeListener,w as setData,n as Icon,x as Panel}from"./chunk-b74ece54.js";import{a as niceDate}from"./chunk-2e16b4c0.js";function today({history:e}){return new Date}function history({data:e}){if(e.treatments){const t=e.treatments.reduce((e,t)=>{const a=niceDate(t.created);return e[a]||(e[a]=[]),e[a].push(t),e},{});return Object.keys(t).map(e=>({date:e,remedies:t[e]}))}return[]}function data(){return{history:[],visible:5,showAll:!1,filter:"",add_remedy:!1,is_static:!1}}var methods={showAll(){this.set({showAll:!0})},edit(e){this.fire("editPrescription",e)}};function oncreate(){this.on("resetSearch",()=>{this.set({filter:""})})}function get_each_context_1(e,t,a){const n=Object.create(e);return n.remedy=t[a].remedy,n.power=t[a].power,n.taking_rule=t[a].taking_rule,n.i=a,n}function click_handler(e){const{component:t,ctx:a}=this._svelte;t.edit(a.item.remedies)}function get_each_context(e,t,a){const n=Object.create(e);return n.item=t[a],n}function create_main_fragment(e,t){var a,n,r,c,s=!t.is_static&&create_if_block_3(e,t),i=null!=t.history&&void 0!==t.history.length&&t.history.length>0&&create_if_block(e,t);return{c(){a=createElement("p"),n=createText("Remedy History\r\n  "),s&&s.c(),r=createText("\r\n\r\n"),c=createElement("div"),i&&i.c(),a.className="title is-5"},m(e,t){insert(e,a,t),append(a,n),s&&s.m(a,null),insert(e,r,t),insert(e,c,t),i&&i.m(c,null)},p(t,n){n.is_static?s&&(s.d(1),s=null):s?s.p(t,n):((s=create_if_block_3(e,n)).c(),s.m(a,null)),null!=n.history&&void 0!==n.history.length&&n.history.length>0?i?i.p(t,n):((i=create_if_block(e,n)).c(),i.m(c,null)):i&&(i.d(1),i=null)},d(e){e&&detachNode(a),s&&s.d(),e&&(detachNode(r),detachNode(c)),i&&i.d()}}}function create_if_block_3(e,t){var a,n,r,c=t.add_remedy?"Cancel":"Add More";function s(a){e.set({add_remedy:!t.add_remedy})}return{c(){a=createElement("span"),n=createElement("button"),r=createText(c),addListener(n,"click",s),n.className="button is-primary",n.type="button",a.className="is-pulled-right"},m(e,t){insert(e,a,t),append(a,n),append(n,r)},p(e,a){t=a,e.add_remedy&&c!==(c=t.add_remedy?"Cancel":"Add More")&&setData(r,c)},d(e){e&&detachNode(a),removeListener(n,"click",s)}}}function create_if_block(e,t){for(var a,n,r,c=t.history,s=[],i=0;i<c.length;i+=1)s[i]=create_each_block(e,get_each_context(t,c,i));var o=t.hasMoreItems&&create_if_block_1(e,t);return{c(){a=createElement("ul");for(var e=0;e<s.length;e+=1)s[e].c();n=createText("\r\n    "),o&&o.c(),r=createComment(),a.className="timeline"},m(e,t){insert(e,a,t);for(var c=0;c<s.length;c+=1)s[c].m(a,null);insert(e,n,t),o&&o.m(e,t),insert(e,r,t)},p(t,n){if(t.history||t.today||t.is_static){c=n.history;for(var i=0;i<c.length;i+=1){const r=get_each_context(n,c,i);s[i]?s[i].p(t,r):(s[i]=create_each_block(e,r),s[i].c(),s[i].m(a,null))}for(;i<s.length;i+=1)s[i].d(1);s.length=c.length}n.hasMoreItems?o?o.p(t,n):((o=create_if_block_1(e,n)).c(),o.m(r.parentNode,r)):o&&(o.d(1),o=null)},d(e){e&&detachNode(a),destroyEach(s,e),e&&detachNode(n),o&&o.d(e),e&&detachNode(r)}}}function create_if_block_2(e,t){var a,n;return{c(){a=createElement("span"),(n=createElement("button")).innerHTML='<span class="icon is-small"><i class="fa fa-pencil"></i></span>',n._svelte={component:e,ctx:t},addListener(n,"click",click_handler),n.type="button",n.className="button is-small",a.className="is-pulled-right"},m(e,t){insert(e,a,t),append(a,n)},p(e,a){t=a,n._svelte.ctx=t},d(e){e&&detachNode(a),removeListener(n,"click",click_handler)}}}function create_each_block_1(e,t){var a,n,r,c,s,i,o,l,d,p,m,h,_,u=t.remedy,f=t.power,y=t.taking_rule;return{c(){a=createElement("tr"),n=createElement("td"),r=createText(u),c=createText("\r\n                  "),s=createElement("td"),i=createText(f),o=createText("\r\n                  "),l=createElement("td"),d=createText(y),p=createText("\r\n                  "),m=createElement("td"),h=createText("\r\n                  "),_=createElement("td")},m(e,t){insert(e,a,t),append(a,n),append(n,r),append(a,c),append(a,s),append(s,i),append(a,o),append(a,l),append(l,d),append(a,p),append(a,m),append(a,h),append(a,_)},p(e,t){e.history&&u!==(u=t.remedy)&&setData(r,u),e.history&&f!==(f=t.power)&&setData(i,f),e.history&&y!==(y=t.taking_rule)&&setData(d,y)},d(e){e&&detachNode(a)}}}function create_each_block(e,t){for(var a,n,r,c,s,i,o,l,d,p,m=t.item.date,h=t.item.date==niceDate(t.today)&&!t.is_static&&create_if_block_2(e,t),_=t.item.remedies,u=[],f=0;f<_.length;f+=1)u[f]=create_each_block_1(e,get_each_context_1(t,_,f));return{c(){a=createElement("li"),n=createElement("span"),r=createElement("strong"),c=createText(m),s=createText("\r\n            "),h&&h.c(),i=createText("\r\n          "),o=createElement("span"),l=createElement("table");for(var e=0;e<u.length;e+=1)u[e].c();d=createText("\r\n\r\n            "),p=createElement("br"),n.className="description",l.className="table has-background-warning-light",o.className="description"},m(e,t){insert(e,a,t),append(a,n),append(n,r),append(r,c),append(n,s),h&&h.m(n,null),append(a,i),append(a,o),append(o,l);for(var m=0;m<u.length;m+=1)u[m].m(l,null);append(o,d),append(o,p)},p(t,a){if(t.history&&m!==(m=a.item.date)&&setData(c,m),a.item.date!=niceDate(a.today)||a.is_static?h&&(h.d(1),h=null):h?h.p(t,a):((h=create_if_block_2(e,a)).c(),h.m(n,null)),t.history){_=a.item.remedies;for(var r=0;r<_.length;r+=1){const n=get_each_context_1(a,_,r);u[r]?u[r].p(t,n):(u[r]=create_each_block_1(e,n),u[r].c(),u[r].m(l,null))}for(;r<u.length;r+=1)u[r].d(1);u.length=_.length}},d(e){e&&detachNode(a),h&&h.d(),destroyEach(u,e)}}}function create_if_block_1(e,t){var a,n,r,c,s,i,o,l,d,p,m,h=t.history.length-t.visible,_=new Icon({root:e.root,store:e.store,data:{icon:"chevron-down"}});function u(t){e.showAll()}return{c(){a=createElement("div"),n=createElement("div"),r=createElement("hr"),c=createText("\r\n        "),s=createElement("button"),_._fragment.c(),i=createText(" "),o=createElement("span"),l=createText("Show "),d=createElement("strong"),p=createText(h),m=createText(" more items"),addListener(s,"click",u),s.className="button is-info is-small is-fullwidth",s.type="button",n.className="column",a.className="columns"},m(e,t){insert(e,a,t),append(a,n),append(n,r),append(n,c),append(n,s),_._mount(s,null),append(s,i),append(s,o),append(o,l),append(o,d),append(d,p),append(o,m)},p(e,t){(e.history||e.visible)&&h!==(h=t.history.length-t.visible)&&setData(p,h)},d(e){e&&detachNode(a),_.destroy(),removeListener(s,"click",u)}}}function Timeline(e){init(this,e),this._state=assign(data(),e.data),this._recompute({data:1,history:1},this._state),this._intro=!0,this._fragment=create_main_fragment(this,this._state),this.root._oncreate.push(()=>{oncreate.call(this),this.fire("update",{changed:assignTrue({},this._state),current:this._state})}),e.target&&(this._fragment.c(),this._mount(e.target,e.anchor),flush(this))}assign(Timeline.prototype,proto),assign(Timeline.prototype,methods),Timeline.prototype._recompute=function(e,t){e.data&&this._differs(t.history,t.history=history(t))&&(e.history=!0),e.history&&this._differs(t.today,t.today=today(t))&&(e.today=!0)};export{Timeline as a};
//# sourceMappingURL=chunk-e8abfd15.js.map
